<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SIGNUP</title>

    <style>
      .centered-form-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 150vh;
      }
      
      .form-box {
        width: 400px;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      
      .form-row {
        margin-bottom: 20px;
      }
      
      .form-row label {
        font-weight: bold;
      }
      
      .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      
      .btn-primary {
        background-color: #007bff;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
      }
      
      .btn-primary:hover {
        background-color: #0056b3;
      }
      
      .signup-form {
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
        padding: 30px;
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
      }
      
        .otp-form-container {
          justify-content: center;
          align-items: center;
          height: 30vh;
          background-color: #f8f9fa;
        }
      
        .otp-form {
          width: 300px;
          padding: 20px;
          background-color: #fff;
          border-radius: 5px;
          box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
          margin-bottom : 10px;
        }
      
        .otp-form input[type="text"] {
          width: 100%;
          padding: 10px;
          margin-bottom: 10px;
          border: 1px solid #ddd;
          border-radius: 5px;
          margin-bottom : 10px;
        }
      
        .otp-button {
          width: 100%;
          padding: 10px;
          margin-top: 15px;
          margin-bottom: 10px;
          background-color: #007bff;
          color: #fff;
          border: none;
          border-radius: 5px;
          cursor: pointer;
        }
      
        .otp-button:hover {
          background-color: #0056b3;
        }
    
      .signup-form .btn-primary {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
      }
      
      .signup-form .btn-primary:hover {
        color: #fff;
        background-color: #0069d9;
        border-color: #0062cc;
      }
      
      .signup-form .btn-primary:focus {
        box-shadow: 0 00 0.2rem rgba(38, 143, 255, 0.5);
      }
      
      .signup-form .btn-primary:disabled {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
      }
      
      .signup-form .btn-primary:not(:disabled):not(.disabled):active {
        color: #fff;
        background-color: #0062cc;
        border-color: #005cbf;
      }
      
      .signup-form .btn-primary:not(:disabled):not(.disabled):active:focus {
        box-shadow: 0 0 0 0.2rem rgba(38, 143, 255, 0.5);
      }
      
      @media (max-width: 480px) {
        .form-box {
          width: 90%;
        }
      }
      
    </style>
     <script>
      function redirectToSendOTP() {
        // Redirect to the specified URL
        window.location.href = 'http://localhost:3000/api/send-otp';
      }

      function redirectToVerifyOTP() {
        // Redirect to the specified URL
        window.location.href = 'http://localhost:3000/api/verify-otp';
      }
    </script> 
    <%- include('./partials/head') %>
  </head>
  <body>
    <%- include('./partials/nav') %>

    <div class="centered-form-container">
      <div class="form-box">
        <form id="form-box" action="/user/signup" method="post">
          <div class="form-row">
            <div class="col-md-14 mb-4">
              <label for="validationDefaultfirst"> Fullname </label>
              <div class="input-group">
                <div class="input-group-prepend"></div>
                <input
                  type="text"
                  class="form-control"
                  id="validationDefault01"
                  name="Fullname"
                  placeholder=" Fullname "
                  aria-describedby="inputGroupPrepend3"
                  required
                />
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-14 mb-4">
              <label for="validationDefaultEmail">Email</label>
              <div class="input-group">
                <div class="input-group-prepend"></div>
                <input
                  type="email"
                  class="form-control"
                  id="validationDefaultEmail"
                  name="email"
                  placeholder="email"
                  aria-describedby="inputGroupPrepend3"
                  required
                />
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-14 mb-4">
              <label for="validationDefault06">Password</label>
              <input
                type="password"
                class="form-control"
                id="validationDefault06"
                name="password"
                placeholder="Password"
                required
              />
            </div>
          </div>
          <div class="col-md-14 mb-4">
            <label for="validationDefault05">Role</label>
            <select class="form-control" id="verification" name="role" required>
              <option selected disabled value="">Choose...</option>
              <option>User-side</option>
              <option>Hospital-side</option>
            </select>
          </div>
          <div class="form-row">
            <div class="col-md-14 mb-4">
              <label for="validationDefault08"> Phone Number </label>
              <input
                type="text"
                class="form-control"
                id="validationDefault08"
                name="phone"
                placeholder=" Phone Number "
                required
              />
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-14 mb-4">
              <label for="validationDefault04">Verification Method</label>
              <select
                class="form-control"
                id="verificationMethod"
                name="verificationMethod"
                required
              >
                <option selected disabled value="">Choose...</option>
                <option>SMS</option>
                <option>Email</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <div class="form-check">
                <div class="otp-form-container">
                  <form action="/submit" method="POST" class="otp-form">
                    <input type="text" name="otp" placeholder="Enter OTP" required />
                    <button type="button" class="otp-button" onclick="redirectToSendOTP()">
                      Send OTP
                    </button>
                    <button type="button" class="otp-button" onclick="redirectToVerifyOTP()">
                      Verify OTP
                    </button>
                    <input type="hidden" name="role" value="" />
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="invalidCheck3"
                      required
                    />
                    <label for="invalidCheck3">
                      Would you really like to submit the form?
                    </label>

                    <button type="submit" class="btn btn-primary">Submit</button>
                  </form>
                </div>
            </div>
          </div>
          
          <% include("./partials/script") %>
        </body>
      </html>


<!-- 
     <script src="https://smtpjs.com/v3/smtp.js"></script>
          <div class="otpverify">
            <input
              type="text"
              id="otp_inp"
              placeholder="Enter the OTP sent to your Email..."
              fdprocessedid="yjklu"
            />
            <button class="btn" id="otp-btn" fdprocessedid="yy5dzh">
              Verify
            </button>
          </div>
          <button
            class="send-otp-btn"
            onclick="sendOTP(event)"
            fdprocessedid="ltvn1"
          >
            Send OTP
          </button>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>        
    
    
  <script>
  
         function sendOTP(event) {
        event.preventDefault();
        const email = document.getElementById("validationDefaultEmail");
        const otpverify = document.getElementsByClassName("otpverify")[0];

        let otp_val = Math.floor(Math.random() * 10000);

        let emailbody = `Dear user,<br><br>Thank you for choosing GLOBAL BRIDGE for your business needs. To ensure the security of your account, we require you to verify your email address with a One-Time Password (OTP).<br><h2>Your OTP is: ${otp_val} </h2><br><br>Please enter this OTP on the verification page to complete the verification process. If you did not request this OTP, please ignore this email.<br><br>Thank you,<br>The GLOBAL BRIDGE Team;`;

        Email.send({
          SecureToken: "f77e4f98-9ef2-4c5a-b941-b531a15eb3d4",
          To: email.value,
          From: "22113015@pvgcoet.ac.in",
          Subject: "Email OTP using Emergency Vehicle Management System",
          Body: emailbody,
        }).then((message) => {
          if (message === "OK") {
            alert("OTP sent to your email " + email.value);

            otpverify.style.display = "block";
            const otp_inp = document.getElementById("otp_inp");
            const otp_btn = document.getElementById("otp-btn");

            otp_btn.addEventListener("click", () => {
              if (otp_inp.value == otp_val) {
                alert("Email address verified...");
                otpverify.style.display = "none";
                document.getElementById("sign-up").style.display = "block";
                // Function to send verification email
                sendMail(email.value);
              } else {
                alert("Invalid OTP");
              }
            });
          }
        });
      }

      // Function to send verification email
      function sendMail(email) {
        let emailbody = `Dear user,<br><br>We are delighted to inform you that your email address has been successfully verified for your GLOBAL BRIDGE account. You can now enjoy uninterrupted access to our platform and its features.<br><br>If you have any questions or need assistance, please feel free to contact us. Thank you for choosing GLOBAL BRIDGE.<br><br>Best regards,<br>The GLOBAL BRIDGE Team;`;

        Email.send({
          SecureToken: "f77e4f98-9ef2-4c5a-b941-b531a15eb3d4",
          To: email,
          From: "22113015@pvgcoet.ac.in",
          Subject: "Email Verification Success",
          Body: emailbody,
        });
      }  

      function sendOTP(event) {
        event.preventDefault();
        const email = document.getElementById('validationDefaultEmail');
        console.log(email);
        const otpverify = document.getElementsByClassName('otpverify')[0];
        console.log(otpverify);
        let otp_val = Math.floor(Math.random() * 10000);
        console.log(otp_val);
        let emailbody = `<h2>Your OTP is </h2>${otp_val}`;
        console.log(emailbody);
        Email.send({
          SecureToken : "1217f76c-bdd9-4c5f-a98e-b7db91420368",
          To : email.value,
          From : "22113015@pvgcoet.ac.in",
          Subject : "Email OTP using JavaScript",
          Body : emailbody,
      }).then(
      
        message => {
          if (message === "OK") {
            alert("OTP sent to your email " + email.value);
            console.log(email.value);
            otpverify.style.display = "flex";
            const otp_inp = document.getElementById('otp_inp');
            console.log(otp_inp);
            const otp_btn = document.getElementById('otp-btn');
            console.log(otp_btn);
            otp_btn.addEventListener('click', () => {
              if (otp_inp.value == otp_val) {
                alert("Email address verified...");
              }
              else {
                alert("Invalid OTP");
              }
            })
          }
        }
      );
      }

</script>
      
                                -->

